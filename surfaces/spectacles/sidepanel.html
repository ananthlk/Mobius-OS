<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Möbius Spectacles</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Preload clean fonts if possible, or use system fonts -->
</head>

<body>
  <div id="app" class="app-container">

    <!-- 1. Header & Context Mode -->
    <header class="header">
      <div class="brand">
        <div class="logo-svg-container">
          <svg viewBox="0 0 100 60" class="mobius-logo-svg" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <!-- Shadow filter for depth -->
              <filter id="mobius-shadow-sidepanel" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur in="SourceAlpha" stdDeviation="1.5"/>
                <feOffset dx="1" dy="1" result="offsetblur"/>
                <feComponentTransfer>
                  <feFuncA type="linear" slope="0.3"/>
                </feComponentTransfer>
                <feMerge>
                  <feMergeNode/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
              
              <!-- Top loop gray gradient -->
              <linearGradient id="flow-sidepanel-1" x1="0%" y1="0%" x2="100%" y2="100%" gradientUnits="objectBoundingBox">
                <stop offset="0%" stop-color="#9e9e9e" />
                <stop offset="33%" stop-color="#616161" />
                <stop offset="66%" stop-color="#424242" />
                <stop offset="100%" stop-color="#757575" />
                <animate attributeName="x1" from="0%" to="100%" dur="4s" repeatCount="indefinite" />
                <animate attributeName="y1" from="0%" to="100%" dur="4s" repeatCount="indefinite" />
                <animate attributeName="x2" from="100%" to="0%" dur="4s" repeatCount="indefinite" />
                <animate attributeName="y2" from="100%" to="0%" dur="4s" repeatCount="indefinite" />
              </linearGradient>
              
              <!-- Bottom loop gray gradient - creates twist effect -->
              <linearGradient id="flow-sidepanel-2" x1="100%" y1="0%" x2="0%" y2="100%" gradientUnits="objectBoundingBox">
                <stop offset="0%" stop-color="#757575" />
                <stop offset="33%" stop-color="#424242" />
                <stop offset="66%" stop-color="#616161" />
                <stop offset="100%" stop-color="#9e9e9e" />
                <animate attributeName="x1" from="100%" to="0%" dur="4s" repeatCount="indefinite" />
                <animate attributeName="y1" from="0%" to="100%" dur="4s" repeatCount="indefinite" />
                <animate attributeName="x2" from="0%" to="100%" dur="4s" repeatCount="indefinite" />
                <animate attributeName="y2" from="100%" to="0%" dur="4s" repeatCount="indefinite" />
              </linearGradient>
            </defs>
            
            <!-- Infinity symbol path - top loop -->
            <path d="M30 30 C30 15, 45 15, 50 30 C55 45, 70 45, 70 30"
              stroke="url(#flow-sidepanel-1)" stroke-width="6" fill="none" stroke-linecap="round" filter="url(#mobius-shadow-sidepanel)" />
            
            <!-- Infinity symbol path - bottom loop (twisted) -->
            <path d="M70 30 C70 15, 55 15, 50 30 C45 45, 30 45, 30 30"
              stroke="url(#flow-sidepanel-2)" stroke-width="6" fill="none" stroke-linecap="round" filter="url(#mobius-shadow-sidepanel)" />
          </svg>
        </div>
      </div>
      <div id="context-indicator" class="context-pill">
        <span class="status-dot"></span>
        <span id="context-name">System Idle</span>
      </div>
    </header>

    <!-- 2. Main Chat Interface -->
    <main class="chat-viewport" id="chat-container">
      <div class="message system-message">
        <div class="avatar">
          <svg viewBox="0 0 24 24" class="icon">
            <path
              d="M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"
              fill="currentColor" />
          </svg>
        </div>
        <div class="bubble">
          Möbius is ready. Context: <span id="intro-context">None</span>.
        </div>
      </div>
      <!-- Dynamic Messages Go Here -->
    </main>

    <!-- 3. Context Aware Components (Dynamic) -->
    <section id="context-components" class="context-controls">
      <!-- Injected via JS based on mode -->
    </section>

    <!-- 4. Input Area -->
    <footer class="input-area">
      <div class="input-wrapper">
        <input type="text" id="prompt-input" placeholder="Command the continuum..." autocomplete="off">
        <button id="send-btn" aria-label="Send">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7" />
          </svg>
        </button>
      </div>
    </footer>

  </div>
  <script src="feedback.js"></script>
  <script type="module" src="sidepanel.js"></script>
</body>

</html>